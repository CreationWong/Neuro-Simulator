/* src/style.css */
/* 定义 Twitch 常用颜色变量 - 白色主题 */
:root {
  --twitch-purple: #9147FF; /* 主强调色 */
  --twitch-dark-bg: #F2F2F2; /* 主背景，浅灰色 */
  --twitch-chat-bg: #FFFFFF; /* 聊天室背景，白色 */
  --twitch-text-color: #18181B; /* 主要文字颜色，深色 */
  --twitch-secondary-text-color: #6A6A6D; /* 次要文字颜色，中等灰色 */
  --twitch-border-color: #D3D3D3; /* 边框颜色，浅灰色 */
  --twitch-hover-bg: #EFEFF1; /* 浅灰色 hover 背景 */
  /* Twitch 特定颜色和值 */
  --twitch-button-bg: #EFEFF1; /* 按钮默认背景色 */
  --twitch-button-text-color: #0E0E10; /* 按钮默认文字颜色 */
  --twitch-button-hover-bg: #DFDFE1; /* 按钮 hover 背景色 */
  --twitch-primary-button-bg: var(--twitch-purple); /* 主要按钮背景色 */
  --twitch-primary-button-text-color: #FFFFFF; /* 主要按钮文字颜色 */
  --twitch-primary-button-hover-bg: #772CE8; /* 主要按钮 hover 背景色 */
  --twitch-tag-bg: #EFEFF1; /* 标签背景色 */
  --twitch-tag-text-color: #6A6A6D; /* 标签文字颜色 */
  --twitch-live-red: #EB0400; /* 直播红色指示点/方块 */
  --sidebar-width: 340px; /* 聊天侧边栏的宽度 */
  --header-height: 50px; /* Twitch 页眉高度 */
  --neuro-shadow-color: #32003C; /* Neuro 字幕阴影色 */
  /* 立绘显示宽度百分比，保持固定 */
  --neuro-avatar-display-width-percent: 50%;
  /* 新增：通用过渡效果变量 */
  --fast-transition: background-color 0.2s, color 0.2s;
}
/* 自定义字体 - First Coffee */
@font-face {
  font-family: 'First Coffee';
  src: url('/fonts/first-coffee.woff2') format('woff2');
  font-weight: normal;
  font-style: normal;
}
/* 全局 HTML 和 Body 样式 */
html, body {
  height: 100%;
  margin: 0;
  padding: 0;
  overflow: hidden; /* 确保 body 不滚动 */
}
body {
  font-family: 'Inter', Arial, sans-serif;
  display: flex;
  flex-direction: column;
  background-color: var(--twitch-dark-bg);
  color: var(--twitch-text-color);
}

/* =================================== */
/* === 通用样式类 (优化核心) === */
/* =================================== */

/* --- 通用图标按钮基础样式 --- */
.search-button,
.nav-icon-button,
.chat-toggle-button,
.chat-toolbar-button {
  display: flex;
  align-items: center;
  justify-content: center;
  background: none;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  color: var(--twitch-secondary-text-color);
  transition: var(--fast-transition);
}
/* --- 通用图标按钮 Hover 效果 --- */
.search-button:hover,
.nav-icon-button:hover,
.chat-toggle-button:hover,
.chat-toolbar-button:hover {
  background-color: var(--twitch-hover-bg);
  color: var(--twitch-text-color);
}
/* --- 通用 20px SVG 图标样式 --- */
.nav-link-icon-wrapper svg,
.search-button svg,
.nav-icon-button svg,
#show-chat-button svg,
.chat-toggle-button svg,
.chat-toolbar-button svg {
  width: 20px;
  height: 20px;
  fill: currentColor;
}
/* --- 通用绝对定位全屏覆盖 --- */
#live2d-display,
#startup-video-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

/* =================================== */
/* === 组件样式 (已优化) === */
/* =================================== */

/* === Twitch 页眉 === */
#twitch-header {
  height: var(--header-height);
  background-color: var(--twitch-chat-bg);
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0 1rem;
  border-bottom: 1px solid var(--twitch-border-color);
  flex-shrink: 0;
  z-index: 100;
  color: var(--twitch-text-color);
  gap: 1rem;
}
.top-nav-left, .top-nav-center, .top-nav-right {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}
.top-nav-left, .top-nav-right {
  flex-shrink: 0;
}
.twitch-logo-link {
  display: flex;
  align-items: center;
  text-decoration: none;
  margin-left: 0.5rem;
}
.twitch-logo-container {
  margin: 0;
  transform: scaleY(-1);
  transition: transform 0.3s ease-out;
}
.twitch-logo-container:hover {
  transform: scaleY(1);
}
.twitch-logo-svg .logo-body { fill: var(--twitch-purple); }
.twitch-logo-svg .logo-face { fill: var(--twitch-chat-bg); }
.twitch-logo-svg .logo-eye-path { fill: var(--twitch-purple); }

.nav-links-main {
  display: flex;
  gap: 1.5rem;
  margin-left: 1.5rem;
}
.nav-link {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  text-decoration: none;
  color: var(--twitch-text-color);
  font-weight: 500;
  font-size: 0.95rem;
  padding: 0.25rem 0.5rem;
  border-radius: 4px;
  transition: var(--fast-transition);
}
.nav-link:hover {
  background-color: var(--twitch-hover-bg);
  color: var(--twitch-purple);
}
.nav-link p { margin: 0; }

.top-nav-center {
  flex-grow: 1;
  display: flex;
  justify-content: center;
}
.search-container {
  display: flex;
  width: 100%;
  max-width: 400px;
  border: 1px solid var(--twitch-border-color);
  border-radius: 4px;
  overflow: hidden;
  background-color: var(--twitch-button-bg);
}
.search-input {
  flex-grow: 1;
  padding: 0.5rem 0.75rem;
  border: none;
  background-color: transparent;
  color: var(--twitch-text-color);
  font-size: 0.95rem;
  outline: none;
}
.search-input::placeholder { color: var(--twitch-secondary-text-color); }
.search-button {
  padding: 0.5rem 0.75rem; /* 独立 padding */
  background-color: transparent;
}
.top-nav-right { gap: 0.75rem; }
.nav-icon-button { padding: 0.5rem; } /* 独立 padding */
.nav-user-avatar-button {
  background: none;
  border: none;
  cursor: pointer;
  padding: 0;
  border-radius: 50%;
  width: 32px;
  height: 32px;
  overflow: hidden;
  flex-shrink: 0;
}
.user-avatar-wrapper {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}
.user-avatar-img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 50%;
}

/* === Main Content Area: Stream + Chat === */
#main-content-wrapper {
  flex-grow: 1;
  display: flex;
  overflow: hidden;
  position: relative;
}
#stream-and-info-container {
  flex-grow: 1;
  flex-shrink: 1;
  display: flex;
  flex-direction: column;
  overflow-y: auto;
  min-height: 0;
  scrollbar-width: none; /* Firefox */
}
#stream-and-info-container::-webkit-scrollbar { display: none; } /* Webkit */

#stream-display-viewport {
  flex-grow: 1;
  background-color: #000;
  display: flex;
  justify-content: center;
  align-items: center;
  overflow: hidden;
  min-height: 0;
}
#stream-display-area {
  position: relative;
  background-color: #000;
  overflow: hidden;
  flex-shrink: 0;
  visibility: hidden;
  opacity: 0;
  transition: opacity 0.3s ease-in-out;
}
#live2d-display {
  z-index: 0;
  pointer-events: none;
  background: url('/background.webp') center/cover no-repeat;
}
#neuro-static-avatar-container {
  position: absolute;
  left: 70%;
  transform: translateX(-50%);
  width: var(--neuro-avatar-display-width-percent);
  height: auto;
  overflow: visible;
  pointer-events: none;
  z-index: 15;
  visibility: hidden;
  transition: none;
}
#neuro-static-avatar-container img {
  width: 100%;
  height: auto;
  display: block;
}
#neuro-static-avatar-container.step-2-animate {
  transition: bottom 1s cubic-bezier(0.4, 0.0, 1, 1);
}
#neuro-caption {
  position: absolute;
  bottom: 5%;
  left: 50%;
  transform: translateX(-50%);
  width: 90%;
  padding: 10px 20px;
  border-radius: 10px;
  text-align: center;
  font-size: clamp(0px, 2.5vw, 40px);
  font-weight: normal;
  opacity: 1;
  pointer-events: none;
  z-index: 20;
  color: white;
  transition: none;
  text-shadow: 0 0 4px var(--neuro-shadow-color), 0 0 4px var(--neuro-shadow-color), 0 0 4px var(--neuro-shadow-color);
  font-family: 'First Coffee', cursive;
}
#neuro-caption.show { opacity: 1; }

#startup-video-overlay {
  background-color: black;
  z-index: 10;
  display: flex;
  justify-content: center;
  align-items: center;
  opacity: 1;
  transition: none;
}
#startup-video-overlay.hidden {
  opacity: 0;
  pointer-events: none;
  visibility: hidden;
}
#startup-video {
  width: 100%;
  height: 100%;
  object-fit: contain;
}

/* === Stream Info Area === */
#stream-info {
  display: grid;
  grid-template-columns: auto 1fr;
  gap: 12px;
  padding: 10px 20px;
  background-color: var(--twitch-chat-bg);
  border-bottom: 1px solid var(--twitch-border-color);
  flex-shrink: 0;
}
.streamer-avatar-column {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  flex-shrink: 0;
}
.streamer-avatar-wrapper {
  position: relative;
  margin-top: 15px;
  margin-bottom: 10px;
}
#streamer-avatar {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  flex-shrink: 0;
}
.live-indicator-rect {
  background-color: var(--twitch-live-red);
  color: white;
  font-size: 0.7em;
  font-weight: 700;
  padding: 2px 5px;
  border-radius: 4px;
  position: absolute;
  bottom: -5px;
  left: 50%;
  transform: translateX(-50%);
  white-space: nowrap;
  z-index: 2;
  border: 2px solid var(--twitch-chat-bg);
}
.stream-details-column {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
}
.stream-info-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  width: 100%;
}
.stream-info-row.top-row { margin-bottom: 5px; }
.streamer-name-section {
  display: flex;
  align-items: center;
  gap: 5px;
}
#streamer-nickname {
  margin: 0;
  font-size: 1.2em;
  color: var(--twitch-text-color);
  line-height: 1.2;
  font-weight: 600;
}
.verified-badge {
  display: flex;
  align-items: center;
}
.verified-badge svg {
  width: 16px;
  height: 16px;
  fill: var(--twitch-purple);
}
.action-buttons-section {
  display: flex;
  gap: 8px;
}
.stream-info-row.mid-row { margin-bottom: 0; }
#stream-title-full {
  margin: 0;
  font-size: 0.9em;
  font-weight: 600;
  color: var(--twitch-text-color);
  line-height: 1.3;
  flex-grow: 1;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.stream-stats-section {
  display: flex;
  gap: 15px;
  align-items: center;
  font-size: 0.9em;
  color: var(--twitch-secondary-text-color);
  flex-shrink: 0;
}
.viewer-count, .stream-duration {
  display: inline-flex;
  align-items: center;
  gap: 4px;
}
.viewer-count svg {
  width: 1.1em;
  height: 1.1em;
  fill: currentColor;
  margin-top: -1px;
}
.viewer-count strong, .stream-duration .duration-text {
  font-weight: 600;
  color: var(--twitch-text-color);
}
.stream-info-row.bottom-row {
  align-items: center;
  margin-top: 4px;
}
.stream-category {
  font-size: 0.9em;
  color: var(--twitch-purple);
  text-decoration: none;
  font-weight: 600;
  margin-right: 10px;
  transition: color 0.2s;
  flex-shrink: 0;
}
.stream-category:hover { text-decoration: underline; }
.stream-tags {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  flex-grow: 1;
  align-items: center;
}
.stream-tag {
  display: inline-flex;
  align-items: center;
  padding: 4px 8px;
  border-radius: 100px;
  background-color: var(--twitch-tag-bg);
  color: var(--twitch-tag-text-color);
  font-size: 0.7em;
  font-weight: 600;
  text-decoration: none;
  transition: background-color 0.2s;
  height: 20px;
  box-sizing: border-box;
}
.stream-tag:hover { background-color: var(--twitch-button-hover-bg); }

/* Generic Twitch Button Style */
.twitch-button {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 6px 12px;
  border-radius: 4px;
  font-size: 0.9em;
  font-weight: 600;
  cursor: pointer;
  border: none;
  transition: var(--fast-transition);
  outline: none;
  background-color: var(--twitch-button-bg);
  color: var(--twitch-button-text-color);
}
.twitch-button svg {
  width: 1.2em;
  height: 1.2em;
  fill: currentColor;
}
.twitch-button:hover { background-color: var(--twitch-button-hover-bg); }
.twitch-button.subscribe-button {
  background-color: var(--twitch-primary-button-bg);
  color: var(--twitch-primary-button-text-color);
}
.twitch-button.subscribe-button:hover {
  background-color: var(--twitch-primary-button-hover-bg);
}

/* === Chat & Overlays === */
#show-chat-button {
  position: absolute;
  top: 1rem;
  right: 1rem;
  z-index: 60;
  background-color: rgba(0, 0, 0, 0.6);
  border: none;
  border-radius: 4px;
  padding: 0.5rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  transition: background-color 0.2s, opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
  opacity: 0;
  visibility: hidden;
  pointer-events: none;
}
#show-chat-button:hover { background-color: rgba(0, 0, 0, 0.8); }
body.chat-collapsed #show-chat-button {
  opacity: 1;
  visibility: visible;
  pointer-events: auto;
}
#chat-sidebar {
  width: var(--sidebar-width);
  min-width: var(--sidebar-width);
  background-color: var(--twitch-chat-bg);
  flex-shrink: 0;
  display: flex;
  flex-direction: column;
  border-left: 1px solid var(--twitch-border-color);
  z-index: 50;
  height: 100%;
  transition: width 0.3s ease-in-out, min-width 0.3s ease-in-out;
}
#chat-sidebar.collapsed {
  width: 0;
  min-width: 0;
  overflow: hidden;
  visibility: hidden;
  pointer-events: none;
}
.chat-sidebar-header {
  height: 3.5rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0 1rem;
  border-bottom: 1px solid var(--twitch-border-color);
  flex-shrink: 0;
}
.chat-sidebar-header .chat-title {
  margin: 0;
  font-size: 1rem;
  font-weight: 600;
  color: var(--twitch-text-color);
}
.chat-toggle-button {
  padding: 0.5rem; /* 独立 padding */
  transition: var(--fast-transition), transform 0.3s ease-in-out;
}
#chat-sidebar.collapsed .chat-toggle-button { transform: rotate(180deg); }

.messages-display {
  flex-grow: 1;
  overflow-y: auto;
  padding: 0.5rem 1rem;
  min-height: 0;
  scrollbar-width: thin;
  scrollbar-color: #B0B0B0 var(--twitch-hover-bg);
}
.messages-display::-webkit-scrollbar { width: 8px; }
.messages-display::-webkit-scrollbar-track {
  background: var(--twitch-hover-bg);
  border-radius: 4px;
}
.messages-display::-webkit-scrollbar-thumb {
  background: #B0B0B0;
  border-radius: 4px;
}
.messages-display::-webkit-scrollbar-thumb:hover { background: #888; }

.message {
  padding: 0.25rem 0;
  margin-bottom: 0.25rem;
  max-width: 100%;
  word-wrap: break-word;
  color: var(--twitch-text-color);
  text-align: left;
  line-height: 1.3;
}
.message .username {
  font-weight: bold;
  margin-right: 0.35rem;
  font-size: 0.95rem;
}
.message span:not(.username) { font-size: 0.95rem; }
.message.user-sent-message, .message.audience-ai-message {
  border-radius: 4px;
  padding: 0.25rem 0.5rem;
  margin-bottom: 0.5rem;
}
.message.user-sent-message {
  background-color: rgba(145, 71, 255, 0.1);
  border-left: 3px solid var(--twitch-purple);
}
.message.user-sent-message .username { color: var(--twitch-purple); }
.message.audience-ai-message { background-color: rgba(0, 0, 0, 0.03); }
.message.system-message {
  color: var(--twitch-secondary-text-color);
  font-style: italic;
  text-align: center;
  padding: 0.25rem 0.5rem;
}
.message.system-message .username {
  font-weight: normal;
  color: var(--twitch-secondary-text-color);
}

.chat-input-area {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  padding: 0.75rem 1rem;
  border-top: 1px solid var(--twitch-border-color);
  flex-shrink: 0;
}
.chat-input-toolbar {
  display: flex;
  gap: 0.25rem;
}
.chat-toolbar-button { padding: 0.4rem; } /* 独立 padding */
.chat-toolbar-button .chat-badge-icon {
  width: 20px;
  height: 20px;
}
#chat-input {
  height: 2.25rem;
  padding: 0 0.75rem;
  border: 1px solid var(--twitch-border-color);
  border-radius: 4px;
  background-color: var(--twitch-button-bg);
  color: var(--twitch-text-color);
  font-size: 0.95rem;
  outline: none;
}
#chat-input::placeholder { color: var(--twitch-secondary-text-color); }
#chat-input:focus {
  border-color: var(--twitch-purple);
  box-shadow: 0 0 0 2px rgba(145, 71, 255, 0.2);
}
.chat-send-area {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 0.5rem;
}
.chat-points-display {
  display: flex;
  align-items: center;
  gap: 0.25rem;
  font-size: 0.85rem;
  color: var(--twitch-secondary-text-color);
}
.chat-points-display svg,
.chat-points-display .channel-points-icon {
  width: 18px;
  height: 18px;
  fill: currentColor;
  object-fit: contain;
}
.chat-points-display .points-value {
  color: var(--twitch-text-color);
  font-weight: 600;
}
#send-button.chat-send-button {
  padding: 0.5rem 1rem;
  background-color: var(--twitch-primary-button-bg);
  color: var(--twitch-primary-button-text-color);
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 0.95rem;
  font-weight: 600;
  transition: background-color 0.2s;
}
#send-button.chat-send-button:hover:not(:disabled) {
  background-color: var(--twitch-primary-button-hover-bg);
}
#send-button.chat-send-button:disabled {
  background-color: #B0B0B0;
  cursor: not-allowed;
}